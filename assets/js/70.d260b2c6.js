(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{500:function(t,a,s){t.exports=s.p+"assets/img/image-20200627121618088.4685702e.png"},669:function(t,a,s){"use strict";s.r(a);var e=s(15),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"高可用-replication-集群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#高可用-replication-集群"}},[t._v("#")]),t._v(" 高可用 Replication 集群")]),t._v(" "),e("p",[t._v("上一章，创建了第一组的 3 个容器")]),t._v(" "),e("p",[t._v("REP 1")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("虚拟机")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("IP 地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("端口")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("容器")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("数据卷")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("docker-1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.56.105")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("9003")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rn1(m)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rnv1")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("docker-2")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.56.107")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("9003")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rn2(s)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rnv2")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("docker-3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.56.108")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("9003")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rn3(m)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rnv3")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("docker-1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.56.105")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("9004")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rn4(s)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rnv4")])])])]),t._v(" "),e("p",[t._v("REP 2")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("虚拟机")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("IP 地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("端口")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("容器")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("数据卷")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("docker-2")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.56.107")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("9004")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rn5(m)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rnv5")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("docker-3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.56.108")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("9004")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rn6(s)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rnv6")])])])]),t._v(" "),e("p",[t._v("由于这里，笔者没有开 4 台虚拟机，所以只完成了第一个集群的双主搭建，第二个集群还是单主")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 前面创建了 rn1 容器，这里创建 rn2 容器")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 同时把 rn3 和 rn4 也创建好")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -d -p 9003:3306 --name rn2 -e MYSQL_ROOT_PASSWORD=123456 -v rnv2:/var/lib/mysql --privileged --net=swarm_mysql mysql")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("h2",{attrs:{id:"创建同步账户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建同步账户"}},[t._v("#")]),t._v(" 创建同步账户")]),t._v(" "),e("p",[t._v("从节点需要先登录到主节点，然后才可以复制 binlog 日志，所以要在 "),e("strong",[t._v("主节点")]),t._v(" 上创建一个用于数据同步的账户")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),e("p",[t._v("因为 root 用户权限太高，默认也是不允许远程登录，我们创建普通用户来同步数据。")]),t._v(" "),e("p",[t._v("另外，注意："),e("strong",[t._v("在开启 binlog 日志之前创建同步用户")]),t._v("。否则只能删掉容器从来了。")])]),t._v(" "),e("p",[t._v("为了方便，使用 UI 来创建用户")]),t._v(" "),e("p",[e("img",{attrs:{src:s(500),alt:"image-20200627121618088"}})]),t._v(" "),e("p",[t._v("在服务器权限里面勾选 3 个权限：Super、Reload、Replication Slave")]),t._v(" "),e("h2",{attrs:{id:"配置主节点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置主节点"}},[t._v("#")]),t._v(" 配置主节点")]),t._v(" "),e("p",[t._v("修改配置文件 "),e("code",[t._v("/etc/mysql/my.cnf")]),t._v(" ，加上如下参数")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mysqld"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ncharacter_set_server "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" utf8\nserver_id "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1001")]),t._v("\nlog_bin "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mysql_bin\nrelay_log "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" relay_bin\nlog-slave-updates "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nsql_mode "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br")])]),e("ul",[e("li",[e("p",[e("code",[t._v("server_id")]),t._v("：在 Replication 集群节点中的名称，一个唯一标识")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("log_bin")]),t._v("：开启 binlog 日志，日志名字为 mysql_bin")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("relay_log")]),t._v("：开启 relay_log 日志，并对日志命名")]),t._v(" "),e("p",[t._v("由于配置的是双主，即是主、也是从。所以要开启")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("log-slave-updates")]),t._v("：")]),t._v(" "),e("p",[t._v("由于是要配置双主，在 rn3 节点中，rn1 是从节点，所以从节点要把查询语句也记录在 binlog 日志中，rn3 才能同步到写入的数据。")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("sql_model")]),t._v("：这里主要设置的是数据同步的模式")]),t._v(" "),e("p",[e("code",[t._v("NO_ENGINE_SUBSTITUTION")]),t._v("：创建表的时候，不指定引擎，用默认的 InnoDB")]),t._v(" "),e("p",[e("code",[t._v("STRICT_TRANS_TABLES")]),t._v("：使用事物，在执行 事物 SQL 的时候，执行失败就回滚")])])]),t._v(" "),e("p",[t._v("配置文件不是存放在数据卷中的，所以需要在容器中修改，容器安装 vim 如果慢的话，可以尝试使用数据卷来做中转目录:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("拷贝配置文件在数据卷中，在宿主机上修改")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker exec -it rn1 bash")]),t._v("\nroot@31c9dda3c63c:~"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cp /etc/mysql/my.cnf /var/lib/mysql")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])])]),t._v(" "),e("li",[e("p",[t._v("再把数据卷中的配置文件覆盖原位置的配置文件")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("root@31c9dda3c63c:~"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cp /var/lib/mysql/my.cnf /etc/mysql")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])])])]),t._v(" "),e("p",[t._v("修改完成之后，重启 rn1 容器，然后去数据卷中查看是否有 binlog 的日志文件产生。如果没产生，貌似只能删掉容器重新来一次了，起不起来，就进入不了容器，也修改不了配置文件（肯定是配置文件写错了导致的）")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /var/lib/docker/volumes/rnv1/_data\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 能看到如下文件，就表示可 binlog 开启了已经")]),t._v("\n-rw-r----- "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" polkitd input      "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("154")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("月  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" 01:19 mysql_bin.000001\n-rw-r----- "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" polkitd input       "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("月  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" 01:19 mysql_bin.index\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("p",[t._v("在 index 中保存了创建的所有 binlog 日志文件名称。")]),t._v(" "),e("p",[t._v("那个 relay_log 要连接上主节点，自己作为从节点复制的时候才会出现 relay_log 的文件")]),t._v(" "),e("p",[t._v("再把 rn3 也按照这个配置一下，server_id 记得不要重复了。")]),t._v(" "),e("h2",{attrs:{id:"配置从节点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置从节点"}},[t._v("#")]),t._v(" 配置从节点")]),t._v(" "),e("p",[t._v("修改配置文件 "),e("code",[t._v("/etc/mysql/my.cnf")]),t._v(" ，加上如下参数")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mysqld"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ncharacter_set_server "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" utf8\nserver_id "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1002")]),t._v("\nlog_bin "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mysql_bin\nrelay_log "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" relay_bin\nread-only "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br")])]),e("ul",[e("li",[e("code",[t._v("read-only")]),t._v("：从设置为只读。普通账户只能读")])]),t._v(" "),e("p",[t._v("配置完成后，重启对应的容器，这里配置了 rn2 和 rn4")]),t._v(" "),e("h2",{attrs:{id:"设置主从同步"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设置主从同步"}},[t._v("#")]),t._v(" 设置主从同步")]),t._v(" "),e("p",[t._v("在 "),e("strong",[t._v("从节点上")]),t._v(" 执行如下的语句")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 停止同步服务")]),t._v("\nstop slave"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 改变 master")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在 Swarm 中 ip 不是固定的，建议写主机名，也就是容器名")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 包括端口也是容器的端口")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 因为这个是容器和容器间的交互")]),t._v("\nchange master to "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("master_host")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rn1'")]),t._v(",master_port"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(",master_user"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'backup'")]),t._v(",master_password"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123456'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启同步服务")]),t._v("\nstart slave"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br")])]),e("p",[t._v("注意 master_host ，rn2 连接的是 rn1，rn4 连接的是 rn3，我们之前的规划别搞混了。")]),t._v(" "),e("h2",{attrs:{id:"检查主从同步状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#检查主从同步状态"}},[t._v("#")]),t._v(" 检查主从同步状态")]),t._v(" "),e("p",[t._v("在从节点上执行 "),e("code",[t._v("show slave status")]),t._v(" ，查看结果")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Slave_IO_State")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_Host")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_User")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_Port")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Connect_Retry")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_Log_File")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Read_Master_Log_Pos")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Relay_Log_File")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Relay_Log_Pos")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Relay_Master_Log_File")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Slave_IO_Running")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Slave_SQL_Running")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Replicate_Do_DB")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Replicate_Ignore_DB")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Replicate_Do_Table")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Replicate_Ignore_Table")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Replicate_Wild_Do_Table")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Replicate_Wild_Ignore_Table")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Last_Errno")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Last_Error")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Skip_Counter")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Exec_Master_Log_Pos")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Relay_Log_Space")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Until_Condition")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Until_Log_File")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Until_Log_Pos")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_SSL_Allowed")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_SSL_CA_File")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_SSL_CA_Path")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_SSL_Cert")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_SSL_Cipher")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_SSL_Key")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Seconds_Behind_Master")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_SSL_Verify_Server_Cert")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Last_IO_Errno")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Last_IO_Error")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Last_SQL_Errno")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Last_SQL_Error")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Replicate_Ignore_Server_Ids")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_Server_Id")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_UUID")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_Info_File")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("SQL_Delay")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("SQL_Remaining_Delay")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Slave_SQL_Running_State")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_Retry_Count")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_Bind")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Last_IO_Error_Timestamp")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Last_SQL_Error_Timestamp")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_SSL_Crl")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_SSL_Crlpath")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Retrieved_Gtid_Set")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Executed_Gtid_Set")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Auto_Position")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Replicate_Rewrite_DB")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Channel_Name")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Master_TLS_Version")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("Waiting for master to send event")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("rn1")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("backup")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("3306")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("60")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("mysql_bin.000001")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("154")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("relay_bin.000002")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("367")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("mysql_bin.000001")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("154")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("568")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("None")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("No")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("No")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("1001")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("23855481-b3d8-11ea-987d-02420a000003")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("/var/lib/mysql/master.info")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("NULL")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Slave has read all relay log; waiting for more updates")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("86400")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})])])]),t._v(" "),e("p",[t._v("内容有很多，我们关注两个属性："),e("code",[t._v("Slave_IO_Running")]),t._v(" 和 "),e("code",[t._v("Slave_SQL_Running")]),t._v("，如果都为  yes 就表示 主从同步成功了。")]),t._v(" "),e("p",[t._v("这里要配置：rn2 挂到 rn1 下，rn4 挂到 rn3 下")]),t._v(" "),e("h2",{attrs:{id:"主节点双向同步"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#主节点双向同步"}},[t._v("#")]),t._v(" 主节点双向同步")]),t._v(" "),e("p",[t._v("配置同步方式，上面有，这里配置两次")]),t._v(" "),e("ul",[e("li",[t._v("rn1 配置为 rn 3 的从节点")]),t._v(" "),e("li",[t._v("rn3 配置为 rn1 的从节点")])]),t._v(" "),e("p",[t._v("注意：在 Navicat 上操作的时候，不要操作错数据库了")]),t._v(" "),e("p",[t._v("配置完成之后，就可以测试下是否生效：在 rn1 和 rn3 上写入数据，查看 4 个节点中的数据是否有同步（因为我们配置的是双主同步，一个写节点写入数据，4 个节点上都会有该数据）")]),t._v(" "),e("h2",{attrs:{id:"配置第二个集群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置第二个集群"}},[t._v("#")]),t._v(" 配置第二个集群")]),t._v(" "),e("p",[t._v("REP 2")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("虚拟机")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("IP 地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("端口")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("容器")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("数据卷")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("docker-2")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.56.107")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("9004")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rn5(m)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rnv5")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("docker-3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.56.108")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("9004")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rn6(s)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("rnv6")])])])]),t._v(" "),e("p",[t._v("前面说过了，笔者机器不够，第二个就创建一个单主的集群")]),t._v(" "),e("h2",{attrs:{id:"mycat-配置双主节点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mycat-配置双主节点"}},[t._v("#")]),t._v(" mycat 配置双主节点")]),t._v(" "),e("p",[t._v("之前是 1 个写节点 2 个读节点；现在是双主：1 个写，一个读")]),t._v(" "),e("p",[t._v("schema.xml")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("-- rep1 集群--"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("dataHost "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rep1"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("maxCon")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1000"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("minCon")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("balance")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("writeType")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("dbType")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("dbDriver")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"native"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("switchType")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v("  "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("slaveThreshold")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"100"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("heartbeat"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("select user"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("/heartbeat"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("-- 第一个写 --"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("writeHost "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("host")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r1w1"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("url")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"192.168.56.105:9003"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("password")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("readHost "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("host")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r1r1"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("url")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"192.168.56.107:9003"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("password")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),t._v("/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("/writeHost"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("-- 第二个写 --"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("writeHost "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("host")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r1w2"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("url")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"192.168.56.108:9003"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("password")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("readHost "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("host")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r1r2"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("url")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"192.168.56.105:9004"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("password")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),t._v("/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("/writeHost"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("/dataHost"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("-- rep2 集群--"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("dataHost "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rep2"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("maxCon")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1000"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("minCon")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("balance")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("writeType")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("dbType")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("dbDriver")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"native"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("switchType")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v("  "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("slaveThreshold")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"100"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("heartbeat"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("select user"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("/heartbeat"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("writeHost "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("host")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r2w1"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("url")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"192.168.56.107:9004"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("password")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("readHost "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("host")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r2r1"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("url")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"192.168.56.108:9004"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("user")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("password")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),t._v("/"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("/writeHost"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("/dataHost"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);