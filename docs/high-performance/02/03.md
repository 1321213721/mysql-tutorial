# 基准测试方法

在了解基本概念之后，现在可以来讨论下如何设计和执行基准测试。但是在讨论如何设计好基准测试之前，先来看一下如何避免一些常见的错误，这些错误可能导致测试结果无用或不精准：

- 使用真实数据的子集而不是全集

  例如应用需要处理几百 GB 的数据，但测试只有 1GB 的数据；或则只使用当前数据进行测试，缺希望模拟未来业务大幅度增长后的情况。

- 使用错误的数据分布

  例如：使用均匀分布的数据测试，而系统的真实数据有很多热点区域（随机生成的测试数据通常无法模拟真实的数据分布）

- 使用不真实的分布参数

  例如：假定所有用户的个人信息（profile）都会被平均的读取

- 在多用户场景中，只做单用户的测试

- 在单服务器上测试分布式应用

- 与真实用户行为不匹配

  例如：web 页面中的「思考时间」，真实用户在请求到一个页面后会阅读一段时间，而不是不停顿的点击相关链接。

- 反复执行同一个查询

  真实查询是不尽相同的，这可能会导致缓存命中率降低。而反复执行同一个查询在某种程度上，会全部或则部分缓存结果。

- 没有检查错误

  如果测试结果无法得到合适的解释，比如一个本应该很慢的查询突然变快了。基准测试完成后，一定要检查一下错误日志，这应当是基本的要求。

- 忽略了系统预热（warm up）的过程

  例如系统重启后马上进行测试。有时候需要了解系统重启后需要多长时间才能达到正常的性能容量，要特别留意 **预热的时长**。简单说：有缓存和无缓存的压力测试结果肯定是不同的

- 使用默认的服务器配置

  第三章将信息讨论服务器优化配置

- 测试时间太短

  基准测试需要持续一定的时间。后面会继续讨论该问题

只有避免了上述错误，才能走上改进测试质量的漫漫长路。

