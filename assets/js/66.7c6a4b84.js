(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{473:function(t,a,s){t.exports=s.p+"assets/img/image-20200620221957256.17c3f225.png"},710:function(t,a,s){"use strict";s.r(a);var n=s(15),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"mycat-垂直-水平切分-全局表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mycat-垂直-水平切分-全局表"}},[t._v("#")]),t._v(" Mycat 垂直/水平切分/全局表")]),t._v(" "),n("p",[t._v("垂直切分和水平切分，前面练习的时候已经实现了")]),t._v(" "),n("h2",{attrs:{id:"垂直切分"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#垂直切分"}},[t._v("#")]),t._v(" 垂直切分")]),t._v(" "),n("p",[t._v("就是把数据表 "),n("strong",[t._v("切分成独立的逻辑库")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(473),alt:"image-20200620221957256"}})]),t._v(" "),n("p",[t._v("将不同的集群划分为一个逻辑库，然后交给 mycat 来管理。")]),t._v(" "),n("h2",{attrs:{id:"水平切分"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#水平切分"}},[t._v("#")]),t._v(" 水平切分")]),t._v(" "),n("p",[t._v("MyCat 具有很多 "),n("strong",[t._v("水平切分算法")]),t._v("，用户可以随意定制切分规则。")]),t._v(" "),n("p",[t._v("比如前面的 student 表的取模将数据路由到某一个分片上去。")]),t._v(" "),n("p",[t._v("下面列出一些水平切分的算法。先混个脸熟")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[t._v("分片算法")]),t._v(" "),n("th",[t._v("使用场景")]),t._v(" "),n("th",[t._v("案例")])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("主键球模")]),t._v(" "),n("td",[t._v("初始数据很多，但是增幅较慢")]),t._v(" "),n("td",[t._v("地图数据")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("枚举值")]),t._v(" "),n("td",[t._v("绝大多数场合")]),t._v(" "),n("td",[t._v("58 同城、饿了么")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("日期分片")]),t._v(" "),n("td",[t._v("按照日期查找数据")]),t._v(" "),n("td",[t._v("日志数据")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("自然月分片")]),t._v(" "),n("td",[t._v("按照日期查找数据")]),t._v(" "),n("td",[t._v("财务数据")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("冷数据分片")]),t._v(" "),n("td",[t._v("冷热数据分离")]),t._v(" "),n("td",[t._v("订单数据")])])])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("枚举值：根据一些值决定路由到哪个分片上")]),t._v(" "),n("p",[t._v("比如 58 上浏览网站，需要先让你选择所在城市，然后出现相关的网站内容；招聘、租房等都是按照城市来分片的；")])]),t._v(" "),n("li",[n("p",[t._v("日期分片：")]),t._v(" "),n("p",[t._v("可以按照天来分片，做数据统计和分析就比较方便；")])]),t._v(" "),n("li",[n("p",[t._v("自然月分片：每个月的数据存到一个分片")])])]),t._v(" "),n("h2",{attrs:{id:"mycat-性能参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mycat-性能参数"}},[t._v("#")]),t._v(" Mycat 性能参数")]),t._v(" "),n("p",[t._v("这些都在 Mycat 手册上有相关说明，这里介绍一些，其他的去手册上看")]),t._v(" "),n("ul",[n("li",[t._v("每天 2 亿数据的实时查询案例（手册 239 页）")]),t._v(" "),n("li",[t._v("物联网 26 亿数据的案例（手册 241 页）")]),t._v(" "),n("li",[t._v("大型分布式零售系统案例（首次 241 页）")])]),t._v(" "),n("h2",{attrs:{id:"什么是全局表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是全局表"}},[t._v("#")]),t._v(" 什么是全局表")]),t._v(" "),n("p",[t._v("在 Mycat 中，一种是全局表，一种是分片表。")]),t._v(" "),n("p",[t._v("数据字典表或则数据量不是很大的业务表，都可以定义成 "),n("strong",[t._v("全局表")]),t._v("，在每个分片中的数据都是一样的。")]),t._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("schema")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("checkSQLschema")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("false"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("sqlMaxLimit")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("100"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("table")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("teacher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("global"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("dataNode")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("tdn1,tdn2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("table")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("schema")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("p",[t._v("给虚拟表的 type 设置为 global，就是全局表了。")]),t._v(" "),n("h2",{attrs:{id:"全局表的-sql-路由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#全局表的-sql-路由"}},[t._v("#")]),t._v(" 全局表的 SQL 路由")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("查询语句：")]),t._v(" "),n("p",[t._v("由于所有分片的数据都是一样的，它会随机路由给一个分片执行")])]),t._v(" "),n("li",[n("p",[t._v("INSERT、DELETE、UPDATE 语句：")]),t._v(" "),n("p",[t._v("会路由给每个分片执行")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);